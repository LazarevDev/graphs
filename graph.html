<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script type="text/javascript" src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/graph.css">
    <title>Document</title>
</head>
<body>
    <section class="section">
        <div class="container">
            <div class="titleSection">
                <h2>Логи</h2>
                <p>Per cu iracundia splendide. Vix paulo sanctus scripserit ex, te iriure insolens voluptatum qui. Oratio accumsan et mea. Eu eam dolores lobortis percipitur, quo te equidem deleniti disputando. Postulant assueverit ea his. Eu cum iuvaret debitis voluptatibus, esse perfecto reformidans id has.</p>
                <div class="sectionLine"></div>
            </div>
        </div>
    </section>

    <section>
        <div class="container">
            <div id="mynetwork"></div>
        </div>
    </section>

    <section>
        <div class="container">
            <div class="socialContainer">
                <div class="social-block" id="vk-block">
                    <h3>Вк:</h3>
                    <ul>
                        <li id="vk-friends">Друзья (0/300)</li>
                        <li id="vk-posts">Записи (0/100)</li>
                        <li id="vk-subscriptions">Подписки (0/3000)</li>
                        <li id="vk-comments">Комментарии (0/80)</li>
                    </ul>
                </div>
    
                <div class="social-block" id="facebook-block">
                    <h3>Facebook:</h3>
                    <ul>
                        <li id="fb-friends">Друзья (0/300)</li>
                        <li id="fb-posts">Записи (0/200)</li>
                        <li id="fb-subscriptions">Подписки (0/300)</li>
                        <li id="fb-comments">Комментарии (0/300)</li>
                    </ul>
                </div>
    
                <div class="social-block" id="insta-block">
                    <h3>Инста:</h3>
                    <ul>
                        <li id="insta-posts">Посты (0/300)</li>
                        <li id="insta-subscriptions">Подписки (0/300)</li>
                        <li id="insta-followers">Подписчики (0/300)</li>
                    </ul>
                </div>
    
                <div class="social-block" id="twitter-block">
                    <h3>Твиттер:</h3>
                    <ul>
                        <li id="twitter-posts">Посты (0/300)</li>
                        <li id="twitter-subscriptions">Подписки (0/300)</li>
                        <li id="twitter-followers">Подписчики (0/300)</li>
                    </ul>
                </div>
            </div>
        </div>
    </section>

    <div class="lineContainer">
        <div class="line"></div>
        <div class="line"></div>
        <div class="line"></div>
    </div>

    <script type="text/javascript">
        var nodes = [
            { id: 1, label: '', level: 0, progress: 0 },
            { id: 2, label: 'vk', level: 1, maxProgress: Math.floor(Math.random() * (100 - 10 + 1)) + 10, step: Math.floor(Math.random() * 4) + 1 },
            { id: 3, label: 'Инста', level: 1, maxProgress: Math.floor(Math.random() * (300 - 10 + 1)) + 10, step: Math.floor(Math.random() * 4) + 1 },
            { id: 4, label: 'Фейсбук', level: 1, maxProgress: Math.floor(Math.random() * (300 - 10 + 1)) + 10, step: Math.floor(Math.random() * 4) + 1 },
            { id: 5, label: 'Твиттер', level: 1, maxProgress: Math.floor(Math.random() * (300 - 30 + 1)) + 30, step: Math.floor(Math.random() * 4) + 1 },
            
            { id: 6, label: 'vk-friends', level: 2, progress: 0, maxProgress: Math.floor(Math.random() * (300 - 10 + 1)) + 10, step: Math.floor(Math.random() * 4) + 1 },
            { id: 7, label: 'vk-posts', level: 2, progress: 0, maxProgress: Math.floor(Math.random() * (100 - 10 + 1)) + 10, step: Math.floor(Math.random() * 4) + 1 },
            { id: 8, label: 'vk-subscriptions', level: 2, progress: 0, maxProgress: Math.floor(Math.random() * (3000 - 10 + 1)) + 10, step: Math.floor(Math.random() * 4) + 1 },
            { id: 9, label: 'vk-comments', level: 2, progress: 0, maxProgress: Math.floor(Math.random() * (80 - 10 + 1)) + 10, step: Math.floor(Math.random() * 4) + 1 },
            
            { id: 10, label: 'insta-followers', level: 2, progress: 0, maxProgress: Math.floor(Math.random() * (300 - 10 + 1)) + 10, step: Math.floor(Math.random() * 4) + 1 },
            { id: 11, label: 'insta-posts', level: 2, progress: 0, maxProgress: Math.floor(Math.random() * (200 - 10 + 1)) + 10, step: Math.floor(Math.random() * 4) + 1 },
            { id: 12, label: 'insta-subscriptions', level: 2, progress: 0, maxProgress: Math.floor(Math.random() * (300 - 10 + 1)) + 10, step: Math.floor(Math.random() * 4) + 1 },
            
            // { id: 13, label: 'Комментарии', level: 2, progress: 0, maxProgress: Math.floor(Math.random() * (60 - 10 + 1)) + 10, step: Math.floor(Math.random() * 4) + 1 },
            { id: 14, label: 'fb-friends', level: 2, progress: 0, maxProgress: Math.floor(Math.random() * (300 - 10 + 1)) + 10, step: Math.floor(Math.random() * 4) + 1 },
            { id: 15, label: 'fb-posts', level: 2, progress: 0, maxProgress: Math.floor(Math.random() * (300 - 30 + 1)) + 30, step: Math.floor(Math.random() * 4) + 1 },
            { id: 16, label: 'fb-subscriptions', level: 2, progress: 0, maxProgress: Math.floor(Math.random() * (300 - 10 + 1)) + 10, step: Math.floor(Math.random() * 4) + 1 },
            { id: 17, label: 'fb-comments', level: 2, progress: 0, maxProgress: Math.floor(Math.random() * (300 - 10 + 1)) + 10, step: Math.floor(Math.random() * 4) + 1 },
            
            // { id: 18, label: 'Друзья', level: 2, progress: 0, maxProgress: Math.floor(Math.random() * (300 - 10 + 1)) + 10, step: Math.floor(Math.random() * 4) + 1 },
            { id: 19, label: 'twitter-posts', level: 2, progress: 0, maxProgress: Math.floor(Math.random() * (300 - 10 + 1)) + 10, step: Math.floor(Math.random() * 4) + 1 },
            { id: 20, label: 'twitter-subscriptions', level: 2, progress: 0, maxProgress: Math.floor(Math.random() * (300 - 10 + 1)) + 10, step: Math.floor(Math.random() * 4) + 1 },
            { id: 21, label: 'twitter-followers', level: 2, progress: 0, maxProgress: Math.floor(Math.random() * (300 - 10 + 1)) + 10, step: Math.floor(Math.random() * 4) + 1 }
        ];

        var edges = [
            { from: 1, to: 2 },
            { from: 1, to: 3 },
            { from: 1, to: 4 },
            { from: 1, to: 5 },
            { from: 2, to: 6 },
            { from: 2, to: 7 },
            { from: 2, to: 8 },
            { from: 2, to: 9 },
            { from: 3, to: 10 },
            { from: 3, to: 11 },
            { from: 3, to: 12 },
            { from: 3, to: 13 },
            { from: 4, to: 14 },
            { from: 4, to: 15 },
            { from: 4, to: 16 },
            { from: 4, to: 17 },
            { from: 5, to: 18 },
            { from: 5, to: 19 },
            { from: 5, to: 20 },
            { from: 5, to: 21 }
        ];

        var container = document.getElementById('mynetwork');
        var data = {
            nodes: nodes,
            edges: edges
        };
        var options = {
            layout: {
                hierarchical: {
                    direction: 'UD',
                    sortMethod: 'directed'
                }
            },
            interaction: {
                dragNodes: false // запрет перетаскивания узлов
            },
            physics: {
                enabled: false,
            },
            nodes: {
                shape: 'circle',
                borderWidth: 2, // ширина обводки узлов
                color: {
                    border: 'white', // цвет обводки узлов
                    background: 'rgba(36, 38, 46, 1)', // прозрачный цвет внутри узлов (белый с нулевой прозрачностью)
                    highlight: {
                        border: 'white', // цвет обводки узлов при выделении
                        background: 'rgba(36, 38, 46, 1)' // цвет внутри узлов при выделении
                    },
                    hover: {
                        border: 'white', // цвет обводки узлов при наведении
                        background: 'rgba(255, 255, 255, 0.3)' // цвет внутри узлов при наведении
                    }
                },
                font: {
                    color: 'white' // цвет текста внутри узлов
                }
            }
        };

        var network = new vis.Network(container, data, options);

        function animateProgress() {
            nodes.forEach(function(node) {
                if (node.maxProgress) {
                    var delay = Math.floor(Math.random() * 13000); // Случайная задержка от 0 до 13000 миллисекунд
                    setTimeout(function() {
                        var interval = setInterval(function() {
                            if (node.progress < node.maxProgress) {
                                node.progress++;
                                updateNodeLabel(node);
                                updateSocialBlock(node.label.toLowerCase(), node.progress, node.maxProgress); // Добавлено обновление данных в социальных блоках
                            } else {
                                clearInterval(interval);
                            }
                        }, 500);
                    }, delay);
                }
            });
        }

        function updateNodeLabel(node) {
            var label;
            if (node.progress === node.maxProgress) {
                label = ' (' + node.progress + ')';
            } else {
                label =  ' (' + node.progress + '/' + node.maxProgress + ')';
            }
            network.body.data.nodes.update({ id: node.id, label: label });
        }

        function updateSocialBlock(nodeId, progress, maxProgress) {
            var nodeLabel = document.getElementById(nodeId);
            var progressText = progress + '/' + maxProgress;
            console.log(nodeLabel);
            if (nodeLabel) {
                nodeLabel.textContent = nodeLabel.textContent.split(' ')[0] + ' (' + progressText + ')';
            }
        }

        setTimeout(function() {
            animateProgress();
        }, 1000);
    </script>

</body>
</html>
